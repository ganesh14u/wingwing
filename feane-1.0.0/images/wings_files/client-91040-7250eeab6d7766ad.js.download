"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[91040,3081],{94097:(t,e,i)=>{i.d(e,{Z:()=>E});var n=i(74369),o=i(69420),s=i(94813),a=i(33535),r=i(53614),u=i(50818),d=i(70247),l=i(10208),c=i(47986),m=i(42973),p=i(69694),I=i(53308),U=i(15070),h=i(8420),f=i(87750),g=i(66958),Z=i(44606),_=i(96729),v=i(45106);var C=i(58909);const y=t=>{const{notifyExternalSyncToCart:e}=(0,_.F)(),i=(0,I.I0)(),y=(0,n.useContext)(r.v),z=(0,a.ZP)(),b=(0,s.TH)(),x=(0,o.k6)(),{serverCart:S,draftOrderUUID:O}=(0,d.Dz)(),[k,w]=(0,n.useState)(!1),D=(0,m.Z)("edit_item_dialog"),q=(0,v.Z)(),P=(0,s.TH)().pathname.includes("/cart"),{mutate:E}=(0,f.A)("updateItemInDraftOrderV2",O||""),{mutate:T}=(0,f.A)("updateItemInGroupDraftOrderV2",O||""),A=(0,p.Z)(),B=t.menuItem?.data,Q=(0,C.Z)(),R=(0,n.useCallback)((()=>{y?x.goBack():x.replace((0,c.Zs0)(b))}),[y,x,b]),F=(0,U.v)((t=>{let{outOfItems:e}=t;return e})),{backupProduct:L}=F,M=(0,n.useCallback)((()=>{const n=t.store?.data;if(!B||!n)return;const o=[{sectionUUID:L?.sectionUUID,subsectionUUID:L?.subsectionUUID,title:L?.title,quantity:t.quantity,storeUUID:n.uuid,skuUUID:L?.itemUUID}],s=(0,l.qH)(t.selectedCustomizations,B.customizationsList)||{};z("eats:update_cart_item",{store:(0,u.TG)(n),quantity:t.quantity,...O?{draftOrderUuid:O}:{}});const{isPricedByWeight:a,isSoldByWeight:r,soldByUnit:d}=(0,g.ap)(B),c={uuid:B.uuid,shoppingCartItemUuid:t.cartItemUuid,storeUuid:n.uuid,sectionUuid:B.sectionUuid,subsectionUuid:B.subsectionUuid,price:B.price,title:B.title,quantity:t.quantity,customizations:s,specialInstructions:t.specialInstructions,imageURL:B.imageUrl,fulfillmentIssueAction:Q&&t.outOfItemAction?{type:t.outOfItemAction,itemSubstitutes:"SUBSTITUTE_ITEM"===t.outOfItemAction?o:[]}:{}};if(a&&t.decimalQuantity&&(c.itemQuantity={inSellableUnit:{value:Z.Tf.from(t.decimalQuantity).toE5().toCoefficientDecimal(),measurementUnit:d}},c.pricedByUnit=B?.purchaseInfo?.pricingInfo?.pricedByUnit,c.quantity=r?1:c.quantity,c?.fulfillmentIssueAction?.itemSubstitutes?.[0]&&(c.fulfillmentIssueAction.itemSubstitutes[0].itemQuantity=c.itemQuantity,c.fulfillmentIssueAction.itemSubstitutes[0].quantity=c.quantity)),A){w(!0);(A.isGroupOrder?T:E)({draftOrderUUID:O,cartUUID:A.cartUUID,item:c}).then((()=>{e({cartId:A.draftOrderUUID??"",storeId:n.uuid}),i((0,h.im)())}))}}),[Q,t.store?.data,t.quantity,t.selectedCustomizations,t.cartItemUuid,t.specialInstructions,t.outOfItemAction,t.decimalQuantity,B,L?.sectionUUID,L?.subsectionUUID,L?.title,L?.itemUUID,z,O,A,T,E,i,e]),$=(0,n.useCallback)((function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];D({shoppingCartItemUUIDs:[t.cartItemUuid]}),e&&1===S.data?.items.length&&(q||P)?z("eats:remove_item_from_cart_dialog_close"):t.onRemoveItem()}),[D,t,S.data?.items.length,q,P,z]);return(0,n.useEffect)((()=>{!S.isLoading&&S.hasLoaded&&k&&R()}),[k,S,R]),t.children({updateItem:M,removeItem:$})};var z=i(31139),b=i(78665),x=i(1795),S=i(64388),O=i(31755),k=i(47857),w=i(98976),D=i(49723),q=i(59924);const P=t=>{let{cartItem:e,store:i,menuItem:o,onRemoveItem:s,children:a}=t;const[r,u]=n.useState(""),{partialMenuItem:d}=(0,O.Z)(i,e?.storeUuid,e?.sectionUuid,e?.subsectionUuid,e?.uuid),{outOfItemAction:l,updateOutOfItemAction:c,backupProduct:m,specialInstructions:p,updateSpecialInstructions:I}=(0,D.Z)(),{quantity:U,decimalQuantity:h,updateQuantity:f,updateCustomizations:g,selectedCustomizations:Z,hasErrors:_,totalPrice:v,firstIncompleteGroup:C,discountedPrice:b}=(0,z.e3)();return(0,q.tZ)(y,{cartItemUuid:e.shoppingCartItemUuid,store:i,menuItem:o,selectedCustomizations:Z,quantity:U,decimalQuantity:h,specialInstructions:p||"",onRemoveItem:s,outOfItemAction:l,children:t=>{let{updateItem:e,removeItem:n}=t;return a({store:i,menuItem:o,partialMenuItem:d,quantity:U,updateQuantity:f,specialInstructions:p,updateSpecialInstructions:I,updateCustomizations:g,selectedCustomizations:Z,hasErrors:_,totalPrice:v,updateItem:e,removeItem:n,firstIncompleteGroup:C,incompleteSubmissionState:r,setIncompleteSubmissionState:t=>u(t),outOfItemAction:l,updateOutOfItemAction:c,backupProduct:m,discountedPrice:b})}})},E=t=>{const{isLoading:e,cartItem:i}=(0,b.Z)(t.itemUuid),{store:o}=(0,S.ZP)(i?.storeUuid),s=(0,w.hn)((0,k.A)({storeUuid:i?.storeUuid||"",sectionUuid:i?.sectionUuid||"",subsectionUuid:i?.subsectionUuid||"",menuItemUuid:i?.uuid||"",cbType:"EATER_ENDORSED"},{preparedId:"checkout-edit-item-menu-item",queryObserverOptions:{enabled:Boolean(i?.storeUuid&&i.sectionUuid&&i.subsectionUuid&&i.uuid)}})),{specialInstructionsState:a,setInitialSpecialInstructions:r}=(0,D.Z)();return n.useEffect((()=>{!e&&i&&"STALE"===a.status&&r(i.specialInstructions)}),[e]),e?(0,q.tZ)(x.Z,{}):i?(0,q.tZ)(z.ZP,{itemParams:{storeUuid:i.storeUuid,sectionUuid:i.sectionUuid,subsectionUuid:i.subsectionUuid,itemUuid:i.uuid},editItemParams:{isEditQuantityFlow:!0,initialQuantity:i.quantity,initialDecimalQuantity:Z.Tf.maybeFrom(i.itemQuantity?.inSellableUnit?.value),initialCustomizations:i.customizations,initialSpecialInstructions:i.specialInstructions},isEditItemFlow:!0,children:(0,q.tZ)(P,{cartItem:i,store:o,menuItem:s,onRemoveItem:t.onRemoveItem,children:t.children})}):null}},__fusion__23:(t,e,i)=>{i.r(e),i.d(e,{default:()=>S});var n=i(20196),o=i(94097),s=i(74369),a=i(69420),r=i(44369),u=i(47986),d=i(86080),l=i(98976),c=i(1795),m=i(93801),p=i(40606),I=i(94813),U=i(75161),h=i(56899),f=i(53614),g=i(59924);const Z=t=>{const e=(0,I.TH)(),i=(0,a.k6)(),n=(0,s.useContext)(f.v),{customizationRefUuids:o=[]}=(0,u.vRw)(),Z=(0,u.C45)(e),_="quickView"===r.parse(e?.search)?.mod;return(0,g.tZ)(U.u_,{onClose:()=>{if(!n)return i.push(Z);let t=parseInt(o.length/2);_&&t++,i.go(-1*t)},isOpen:!0,size:h.NO.auto,children:(0,g.tZ)(p.Z,{source:(0,l.FP)(t.store,t.menuItem),loaded:e=>{let[i,n]=e;return(0,g.tZ)(d.Z,{store:i,item:n,rootLevelCustomizations:t.initialCustomizations,isOnSale:t.isOnSale,saveCustomizations:t.saveCustomizations,quantity:t.quantity,customizationRefUuids:o})},error:t=>{let{code:e}=t;return(0,g.tZ)(m.Qv,{code:e})},loading:()=>(0,g.tZ)(c.Z,{})})})};var _=i(24857),v=i("__fusion__18"),C=i(8420),y=i(53308),z=i(70247),b=i(94579),x=i(33535);const S=(0,z.m0)((()=>{const t=(0,y.I0)(),{customizationRefUuids:e=[],itemUuid:i=""}=(0,u.vRw)(),s=(0,x.ZP)();return(0,g.tZ)(n.ZP,{overrides:{PlacementContainer:{style:{zIndex:b.I_.banner}},Root:{style:{marginTop:"32px"}}},children:(0,g.tZ)(_.ZP,{parentContext:"edit",children:(0,g.tZ)(o.Z,{itemUuid:i,onRemoveItem:()=>{t((0,C.im)()),s("eats:remove_item_from_cart_dialog_close")},children:t=>e.length>0?(0,g.tZ)(Z,{store:t.store,initialCustomizations:t.selectedCustomizations,menuItem:t.menuItem,isOnSale:!0,saveCustomizations:t.updateCustomizations,quantity:t.quantity}):(0,g.tZ)(v.ProductDetailsDesktopQuickViewContent,{isEditItemFlow:!0,updateItem:t.updateItem,removeItem:t.removeItem,specialInstructions:t.specialInstructions,updateSpecialInstructions:t.updateSpecialInstructions})})})})}))},__fusion__18:(t,e,i)=>{i.r(e),i.d(e,{ProductDetailsDesktopQuickViewContent:()=>mt,default:()=>It});var n=i(75514),o=i("__fusion__476"),s=i(69420),a=i(44369),r=i(40606),u=i(93801),d=i(94813),l=i(31139),c=i(98976),m=i(51820),p=i(91931),I=i(33855),U=i(99955),h=i(14016),f=i(47986),g=i(86695),Z=i(68065),_=i("__fusion__927"),v=i(20196),C=i(83059),y=i(55811),z=i(84416),b=i(33535),x=i(31755),S=i(75787),O=i(1795),k=i(87345),w=i(34936),D=i(46933),q=i(97415),P=i(67206),E=i(52298),T=i(59924);const A=(0,p.zo)("div",{marginTop:"40px"}),B=(0,p.zo)("div",(t=>{let{$theme:e}=t;return{...(0,P.Z)({$theme:e}),backgroundSize:"100vw 100%",position:"absolute",top:0,bottom:0,left:0,right:0}})),Q=(0,p.zo)("div",(t=>{let{$theme:e}=t;return{width:"492px",flexDirection:"column",display:"flex",alignItems:"flex-start",height:"fit-content",justifyContent:"flex-start",flexShrink:0,overflow:"hidden"}})),R=(0,p.zo)("div",{width:"492px",paddingTop:"4px",flex:"1 1 100%"}),F=(0,p.zo)("div",(t=>{let{$theme:e}=t;return{display:"flex",flexDirection:"row",gap:"24px"}})),L=(0,p.zo)("div",{position:"relative",display:"flex",flexDirection:"column"}),M=(0,p.zo)("div",(t=>{let{$theme:e,$zIndex:i}=t;return{width:"18px",height:"36px",background:`radial-gradient(circle at 100%, transparent 18px, ${e.colors.backgroundPrimary} 18px)`,...i?{zIndex:i}:null}})),$=(0,p.zo)("div",(t=>{let{$theme:e,$zIndex:i}=t;return{width:"18px",height:"36px",background:`radial-gradient(circle at 0%, transparent 18px, ${e.colors.backgroundPrimary} 18px)`,...i?{zIndex:i}:null}})),N=(0,p.zo)("div",{flex:"none",display:"flex",alignItems:"center",width:"fit-content",position:"relative"}),H=t=>{let{partialMenuItem:e,itemUuid:i,store:n}=t;if(!e)return(0,T.tZ)(O.Z,{});const o=e.imageUrl?[{imageUrl:e.imageUrl}]:[],s=o.length>0?(0,T.tZ)(w.Z,{images:o,itemUuid:i,storeUuid:n.data?.uuid}):null;return(0,T.BX)(A,{children:[(0,T.tZ)(k.Z,{children:e.title}),(0,T.BX)(F,{children:[(0,T.tZ)(Q,{children:s||(0,T.tZ)(S.Z,{title:e.title,images:[{imageUrl:e.imageUrl}],description:e.description,endorsement:null,nutritionalInfo:null,rules:null,tagSection:null,hideImage:!0})}),(0,T.BX)(R,{children:[s?(0,T.tZ)(S.Z,{title:e.title,images:[{imageUrl:e.imageUrl}],description:e.description,endorsement:null,nutritionalInfo:null,rules:null,tagSection:null,hideImage:!0}):null,(0,T.BX)(L,{children:[(0,T.BX)(N,{children:[(0,T.tZ)(B,{}),(0,T.tZ)(M,{$zIndex:1}),(0,T.tZ)(q.CB,{$width:"24px"}),(0,T.tZ)($,{$zIndex:1})]}),(0,T.tZ)(E.ZP,{$height:24}),(0,T.tZ)(g.zx,{disabled:!0,isFullWidth:!0,size:Z.NO.large,children:(0,T.tZ)(D.v,{id:"shared.add_to_cart"})})]})]})]})]})};var V=i(37771),X=i(75161),G=i(56899),W=i(91086),Y=i(33259),j=i(95747),K=i(87835),J=i(23017),tt=i(67476),et=i(8420),it=i(53308),nt=i(17198),ot=i(95394),st=i(67212),at=i(52949),rt=i(2842),ut=i(32135);const dt=(0,at.V)({chunkId:"draft-order-desktop-start-new-order-root",load:()=>Object.defineProperties(i.e(94813).then(i.bind(i,"__fusion__384")),{__CHUNK_IDS:{value:[94813]},__MODULE_ID:{value:"__fusion__384"},__I18N_KEYS:{value:["go.cancel_this_order","go.cancel_this_order_description","go.create_new_order","go.keep_order","go.leave_group_order_new_individual_order_description","shared.cancelOrder","shared.createNewOrder","shared.createNewOrderExplanation","shared.goBack","shared.newOrder"]}}),LoadingComponent:O.Z,ErrorComponent:rt.D}),lt=(0,p.zo)("div",{padding:"24px"}),ct=(0,p.zo)("div",{padding:"0 24px 24px 24px",marginTop:"-40px"}),mt=t=>{let{isEditItemFlow:e=!1,updateItem:i,removeItem:p,specialInstructions:S,updateSpecialInstructions:O}=t;const{sentinelHidden:k,sentinelRef:w}=(0,V.U)(),{store:D,menuItem:q,selectedCustomizations:P,isOnSale:E,updateCustomizations:A,quantity:B,hasErrors:Q}=(0,l.e3)(),R=(0,s.k6)(),F=(0,U.Z)(Boolean(e)),L=Boolean(F?.startNewOrder),M=(0,it.I0)(),{enqueue:$,dequeue:N}=(0,v.Ds)(),nt=(0,h.T)(),at=(0,d.TH)(),rt="postmates"===(0,y.Z)()?z.n2:void 0,{creatorLockedOrderDescriptionCopy:mt}=(0,J.Z)(),{canEditGroupOrderCart:pt}=(0,tt.Z)(F?.storeUuid||""),It=o.useCallback(((t,e)=>{$({message:t,actionMessage:e,actionOnClick:()=>N()},C.t.short)}),[$,N]),Ut=(0,b.ZP)(),{partialMenuItem:ht}=(0,x.Z)(D,F?.storeUuid,F?.sectionUuid,F?.subsectionUuid,F?.itemUuid),ft=(0,j.Z)();(0,K.Z)({store:D,menuItem:q,hasErrors:Q,source:e?"quick_view_edit_item":"quick_view",isOnSale:E});const{modalOpen:gt,onModalClose:Zt,openDeliveryLocationModal:_t}=(0,ot.y)(!0),vt=()=>{M((0,et.im)());const{passCampaign:t}=(0,f.RAN)(at,["passCampaign"]);if(t===ut.xn.UPSELL_EXCLUSIVE_FOMO){const t=a.parse(at.search);delete t[f.FSm.passCampaign];const e={...at,search:t};R.replace((0,f.C45)(e))}else ft((0,f.C45)(at))};if(o.useEffect((()=>{mt&&!pt&&It(mt,nt("shared.dismiss"))}),[mt,pt,It,nt]),!F)return null;if(F?.customizationRefUuids?.length)return(0,T.tZ)(I.Z,{store:D,menuItem:q,initialCustomizations:P,isOnSale:E,saveCustomizations:A,quantity:B});const Ct=()=>{p&&p(),vt()};return(0,T.tZ)(T.HY,{children:L?(0,T.tZ)(dt,{}):gt?(0,T.tZ)(st.Z,{onClose:Zt}):(0,T.tZ)(X.u_,{onClose:vt,size:G.NO.auto,children:(0,T.tZ)(r.Z,{source:(0,c.FP)(D,q),loaded:t=>{let[o,s]=t;const a=(0,f.yz4)({location:at,args:{sectionUuid:F.sectionUuid,subsectionUuid:F.subsectionUuid,itemUuid:F.itemUuid,storeUuid:F.storeUuid,storeSlug:o.slug}});return Ut("eats:quick_view_dialog_impression",{storeCatalog:{sectionUuid:F.sectionUuid,subsectionUuid:F.subsectionUuid,itemUuid:F.itemUuid,storeUuid:F.storeUuid}}),(0,T.BX)(T.HY,{children:[(0,T.tZ)(W.xB,{isExpanded:k,title:q.data?.title,leftButton:(0,T.tZ)(Y.hQ,{onClick:vt}),rightButton:(0,T.tZ)(g.zx,{shape:Z.X3.circle,kind:g.TO.tertiary,onClick:()=>{if(Ut("eats:quick_view_dialog_share_click",{storeCatalog:{storeUuid:F.storeUuid,sectionUuid:F.sectionUuid,subsectionUuid:F.subsectionUuid,itemUuid:F.itemUuid}}),!n.Z?.navigator||!a.pathname)return;const t=(0,f.iie)(a.pathname,rt);n.Z.navigator.clipboard.writeText(t).then((()=>{It(nt("shared.link_copied"),nt("shared.dismiss"))}))},children:(0,T.tZ)(_.default,{size:20,title:nt("components.pdp.share_item_title")})}),floatingMode:W.rY.floatingOnceScrolled}),(0,T.tZ)(ct,{children:(0,T.tZ)(m.V,{store:o,item:s,showStoreSelectorWidget:!1,displayContextType:"quick_view",gutterGapWidth:24,showSeeDetailsCTA:F.showSeeDetailsCTA,quickViewModalSentinelRef:w,addToCartSourceType:"quick_view",isEditItemFlow:e,updateItem:i,removeItem:Ct,specialInstructions:S,updateSpecialInstructions:O,openDeliveryLocationModal:_t})})]})},error:t=>(0,T.tZ)(u.nQ,{code:t?.code}),loading:()=>(0,T.tZ)(lt,{children:(0,T.tZ)(H,{store:D,partialMenuItem:ht,itemUuid:F.itemUuid})})})})})},pt=t=>{let{itemParams:e}=t;const{editItemParams:i,shoppingCartItemUuid:n}=(0,nt.Z)({storeUuid:e.storeUuid,itemUuid:e.itemUuid});return(0,T.tZ)(l.ZP,{navigateBackOnItemAdd:!0,itemParams:e,editItemParams:i,shoppingCartItemUuid:n,children:(0,T.tZ)(mt,{isEditItemFlow:!1})})},It=()=>{const t=(0,U.Z)();return t?(0,T.tZ)(pt,{itemParams:t}):null}}}]);