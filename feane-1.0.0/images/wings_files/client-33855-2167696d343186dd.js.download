"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[33855],{86080:(t,e,i)=>{i.d(e,{Z:()=>A});var o=i(21596),n=i.n(o),s=i(74369),a=i(69420),r=i(44369),u=i(94813),l=i(53614),d=i(14016),c=i(47986),m=i(36278),p=i(29194),z=i(91931),h=i(79908),C=i(94579),v=i(31139),g=i(59924);const Z=(0,z.zo)("button",{display:"flex"}),f=(0,z.zo)("div",(t=>{let{$theme:e}=t;return e.typography.HeadingXSmall})),y=(0,z.zo)("div",(t=>{let{$theme:e}=t;return{position:"sticky",padding:"0 16px",display:"flex",flexDirection:"row",alignItems:"center",minHeight:"64px",top:0,zIndex:C.I_.foreground,background:e.colors.backgroundPrimary}})),b=t=>{const e=(0,a.k6)(),i=(0,u.TH)(),o=(0,d.T)(),n=(0,p.gm)(),z=r.parse(i?.search),C=(0,s.useContext)(l.v),{itemParams:b,store:S,menuItem:O}=(0,v.e3)();return(0,g.BX)(y,{children:[(0,g.tZ)(Z,{onClick:t=>{if(t.preventDefault(),t.stopPropagation(),C)return e.goBack();const o=(()=>{const t=S?.data,e=O?.data;if(!t||!e)return!1;const o={storeUuid:t.uuid,storeSlug:t.slug,sectionUuid:e.sectionUuid,subsectionUuid:e.subsectionUuid,itemUuid:e.uuid,primaryBundledStoreUuid:b?.primaryBundledStoreUuid};return"quickView"===z?.mod?(0,c.f_e)(i,o):(0,c.yz4)({location:i,args:o})})();o&&e.replace(o)},"aria-label":o("shared.goBack"),children:(0,g.tZ)(h.Z,{type:"ArrowLeft",rotate:"rtl"===n?180:0})}),(0,g.tZ)(m.ZP,{$width:"16px"}),(0,g.tZ)(f,{children:t.parentCustomizationOption.title})]})},S=t=>{const e=(0,s.useContext)(l.v),i=(0,u.TH)(),{modalName:o}=(0,c.RAN)(i,["modalName"]),n=(0,c.vRw)();if("editItem"!==o)return null;if(e&&t.hasSelectedParentCustomizationOption)return null;const r=(0,c.lVP)(i,{itemUuid:n?.itemUuid});return r?(0,g.tZ)(a.l_,{to:r}):null};var O=i(37649),x=i(70742),U=i(16677),k=i(46933),P=i(10208),L=i(13422),T=i(9545),w=i(67476),I=i(60849),_=i(43426),N=i(51640),B=i(22395),R=i(86695),$=i(68065),q=i(52359);const D=(0,z.zo)("div",(t=>{let{$theme:e,$isAddToCartRevampEnabled:i}=t;return{position:"sticky",bottom:0,padding:"24px",boxSizing:"border-box",...i?{backgroundColor:"white",boxShadow:"0px -4px 16px rgba(0, 0, 0, 0.12)"}:e.overlays.floatingButtonGradient}})),E=t=>{const e=(0,P.qH)(t.selectedCustomizations,t.item.customizationsList)||{},i=(0,L.uT)({itemQuantity:t.quantity,itemPrice:t.item.price||0,customizations:e}),o=i!==(t.item.price||0)*t.quantity,{serverCart:n}=(0,T.Z)(t.storeUuid),{canEditGroupOrderCart:s}=(0,w.Z)(t.storeUuid),a=(0,I.ip)({..._.J.store_add_to_cart_button_revamp,defaultValue:!1}),{isSaveWithPriceTreatment:r,isSaveWithoutPriceTreatment:u,isDoneWithPriceTreatment:l}=(0,q.Z)(),d=()=>{t.hasErrors?t.handleIncompleteGroup():(t.saveCustomizations(t.selectedCustomizations),t.goToDeepestInvalidCustomizationLevel(t.customizationUuidChain,t.customizationOptionUuidChain))};return(0,g.tZ)(D,{$isAddToCartRevampEnabled:a,children:a?(0,g.BX)(R.zx,{disabled:!t.isOnSale||t.isPreview||!s,onClick:d,isFullWidth:!0,size:$.NO.large,isLoading:n.isLoading,style:{height:"56px"},children:[(0,g.tZ)(k.v,{id:"shared.done"}),o?(0,g.BX)(g.HY,{children:[(0,g.tZ)(B.Z,{color:"buttonPrimaryText",typography:"LabelLarge"}),(0,g.tZ)(N.Z,{value:i,currencyCode:t.currencyCode})]}):null]}):l||r?(0,g.tZ)(U.Z,{currencyCode:t.currencyCode,price:i,isDisabled:!t.isOnSale||t.isPreview||n.isLoading||!s,onClick:d,text:r?(0,g.tZ)(k.v,{id:"shared.saveCustomization"}):(0,g.tZ)(k.v,{id:"shared.done"})}):u?(0,g.tZ)(R.zx,{disabled:!t.isOnSale||t.isPreview||n.isLoading||!s,onClick:d,isFullWidth:!0,size:$.NO.large,isLoading:n.isLoading,children:(0,g.tZ)(k.v,{id:"shared.saveCustomization"})}):null})};var W=i(53683),G=i(52692),H=i(91357),F=i(54510);const X=(0,z.zo)("ul",{listStyle:"none",padding:"0px 24px"}),V=(0,z.zo)("div",(t=>{let{$theme:e}=t;return{width:`${W.pM}px`,position:"relative",background:e.colors.backgroundPrimary}})),A=t=>{const{updateCustomizations:e,targetCustomizationsList:i,groupedCustomizationUuids:o,customizationOptionUuids:s,selectedCustomizations:a,parentCustomizationOption:r,goToDeepestInvalidCustomizationLevel:u,hasErrors:l,firstIncompleteGroup:d}=(0,H.Z)(t.rootLevelCustomizations,t.customizationRefUuids,t.item),{incompleteSubmissionState:c,setIncompleteSubmissionState:m}=(0,F.Z)();if(!r)return null;const p={...t.rootLevelCustomizations,...a},z=n()(p).filter((t=>t.find((t=>t.uuid===r?.uuid)))).length;return(0,g.BX)(V,{children:[(0,g.tZ)(S,{hasSelectedParentCustomizationOption:Boolean(z)}),(0,g.tZ)(O.Z,{eventName:"eats:menu_item_customization"}),r?(0,g.tZ)(b,{parentCustomizationOption:r}):null,(0,g.tZ)(X,{children:i.map((i=>{const n=(0,P.ys)(i);return(0,g.tZ)("li",{children:(0,g.tZ)(x.Z,{customization:i,updateCustomizations:e,selectedCustomizations:a,currencyCode:t.store.currencyCode,isOnSale:t.isOnSale,customizationUuidChain:o.concat(n),customizationOptionUuidChain:s,customizationsList:t.item.customizationsList,setIncompleteSubmissionState:m,incompleteSubmissionState:c,firstIncompleteGroup:d})},n)}))}),(0,g.tZ)(G.Z,{$color:"borderSecondary",$margin:"0"}),(0,g.tZ)(E,{item:t.item,quantity:t.quantity,currencyCode:t.store.currencyCode,saveCustomizations:t.saveCustomizations,customizationUuidChain:o,customizationOptionUuidChain:s,goToDeepestInvalidCustomizationLevel:u,hasErrors:l,selectedCustomizations:a,handleIncompleteGroup:()=>{m(d)},isOnSale:t.isOnSale,isPreview:t.store.isPreview,storeUuid:t.store.uuid})]})}},33855:(t,e,i)=>{i.d(e,{Z:()=>Z});var o=i(74369),n=i(69420),s=i(44369),a=i(47986),r=i(86080),u=i(98976),l=i(1795),d=i(93801),c=i(40606),m=i(99955),p=i(94813),z=i(26146),h=i(75161),C=i(56899),v=i(53614),g=i(59924);const Z=t=>{const e=(0,n.k6)(),i=(0,p.TH)(),Z=(0,p.UO)(),f=(0,a.x9r)(Z),y=(0,m.Z)(),b=(0,o.useContext)(v.v),S=y?.customizationRefUuids?.length?y.customizationRefUuids:f.customizationRefUuid.split("/"),O=(0,a.C45)(i),x=(0,z.x)(),U="quickView"===s.parse(i?.search)?.mod;return(0,g.tZ)(h.u_,{isOpen:!0,onClose:()=>{if(!b)return e.push(O);let t=parseInt(S.length/2);U&&t++,e.go(-1*t)},size:C.NO.auto,children:(0,g.tZ)(c.Z,{source:(0,u.FP)(t.store,t.menuItem),loaded:e=>{let[i,o]=e;return(0,g.tZ)("div",{ref:x,children:(0,g.tZ)(r.Z,{store:i,item:o,rootLevelCustomizations:t.initialCustomizations,isOnSale:t.isOnSale,saveCustomizations:t.saveCustomizations,quantity:t.quantity,customizationRefUuids:S})})},error:t=>{let{code:e}=t;return(0,g.tZ)(d.Qv,{code:e})},loading:()=>(0,g.tZ)(l.Z,{})})})}},26146:(t,e,i)=>{i.d(e,{x:()=>r});var o=i(74369),n=i(94813),s=i(24857),a=i(99955);function r(){const t=(0,n.UO)(),e=(0,a.Z)(),i=e?JSON.stringify(e):JSON.stringify(t),{scrollStateMap:r}=(0,s.iw)(),u=r[i],l=o.useRef(null);return o.useEffect((()=>{l.current&&l.current.scrollTo(0,u??0)}),[u]),l}},52359:(t,e,i)=>{i.d(e,{Z:()=>s});var o=i(57440),n=i(60849);const s=()=>{const t=(0,n.F2)().getString({...o.X.pdp_customizations_cta_text,defaultValue:"default"});return{isSaveWithPriceTreatment:"default"===t,isSaveWithoutPriceTreatment:"save"===t,isDoneWithPriceTreatment:"done_with_price"===t}}},91357:(t,e,i)=>{i.d(e,{Z:()=>a});var o=i(74369),n=i(69420),s=i(10208);function a(t,e,i){const a=(0,n.k6)(),[r,u]=o.useState(t||{}),l=o.useCallback((t=>{u(t)}),[]),d=o.useCallback(((t,e)=>{const o=t.length;let n=o;for(;n>0;){const o=(0,s.PN)(i.customizationsList,t.slice(0,n),e.slice(0,n)),a=(0,s.xe)(o,r,t.slice(0,n),e.slice(0,n));if(Object.keys(a).length>0)break;n--}const u=-1*o+n;a.go(u)}),[r,a,i.customizationsList]),c=e.filter(((t,e)=>e%2==0)),m=c.map((t=>t.split("+")[0]||"")),p=e.filter(((t,e)=>e%2==1)),z=i.customizationsList||[],h=(0,s.PN)(z,m,p),C=(0,s.PQ)(z,m,p),v=(0,s.xe)(h,r,c,p),g=(0,s.h7)(h,Object.keys(v));return{updateCustomizations:l,hasErrors:Object.keys(v).length>0,selectedCustomizations:r,targetCustomizationsList:h,parentCustomizationOption:C,groupedCustomizationUuids:c,customizationUuids:m,customizationOptionUuids:p,goToDeepestInvalidCustomizationLevel:d,firstIncompleteGroup:g}}}}]);