"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[49909,73035,27284,60845],{70305:(e,t,s)=>{s.d(t,{Z:()=>o});var n=s(91931),i=s(94579);const o=(0,n.zo)("div",{width:i.Bj,height:i.eu,position:"relative"})},79154:(e,t,s)=>{s.d(t,{Z:()=>F});var n=s(74369),i=s(11137),o=s("__fusion__476"),r=s(36262),a=s(93649),d=s(66493),l=s(59924);const u=Object.freeze({needsDisplay:"guestadd_v2_needs_display",success:"success",addPaymentError:"add_payment_error",fetchOnboardingFlowsError:"onboarding_flows_fetch_error",userClosed:"user_closed",signIn:"sign_in"});class p extends o.Component{state={dimensions:{height:0,width:0}};constructor(e){super(e),e.dimensions&&(this.state.dimensions=e.dimensions)}resolve=e=>{const{resultCode:t}=e;if(t===u.needsDisplay){const e=this.props.onNeedsDisplay;if(!e)return;const{height:t,width:s}=(0,r.UL)(i.window.innerHeight,i.window.innerWidth),n=e(t,s);return this.setState({dimensions:n})}switch(t){case u.signIn:return void this.props.onCancel(u.signIn,e.orderUuid);case u.userClosed:case a.lw.closed:return void this.props.onCancel(u.userClosed,e.orderUuid);case u.success:return void this.props.onSuccess(e.resultCode,e.orderUuid,e.paymentProfile);case u.fetchOnboardingFlowsError:case u.addPaymentError:case a.lw.openFailed:return void this.props.onError(e.resultCode,e.orderUuid,e.message);default:return}};shouldHideLoader=e=>e&&e.resultCode===u.needsDisplay;resolutionHandler=e=>{this.resolve(e)};render(){const e=(0,r.t0)(this.props,this.state.dimensions),t={orderUuid:this.props.orderUuid,guestUserUuid:this.props.guestUserUuid,activeFlowsUseCaseKey:this.props.activeFlowsUseCaseKey,viewOnlyFlowsUseCaseKey:this.props.viewOnlyFlowsUseCaseKey},s=(0,r.sI)(this.props.origin),n=(0,r.pT)(this.props,"guestadd_v2"),i=(0,r.DZ)(this.props,this.shouldHideLoader),o=this.props.title||"Uber - Add a payment method";return(0,l.tZ)(d.Z,{resolutionHandler:this.resolutionHandler,publishableKey:this.props.publishableKey,useCaseKey:this.props.useCaseKey,integrationName:this.props.integrationName,organizationUuid:this.props.organizationUuid,urlSearchParams:t,embedMode:this.props.embedMode,redirectUrl:this.props.redirectUrl,options:e,url:s,analytics:n,load:i,title:o})}}var c=s(33535),h=s(65602),y=s(95818),m=s(19972),g=s(65478),Z=s(22065),f=s(37649),C=s(85293),b=s(54669),w=s(93553),v=s(91931),x=s(55186),_=s(47986),U=s(94813),H=s(34626),S=s(87696),P=s(92431);function F(e){const{onCancel:t}=e,s="guest-add-payment",i=(0,U.TH)(),o=(0,c.ZP)(),r=(0,Z.Z)(),a=(0,m.Z)(),d=(0,g.Z)(),u=(0,y.Z)(),F=(0,P.Z)(),L=(0,S.Ah)(F),E=(t,n,i)=>{o("eats:payments_hub_end",{paymentsHubEnd:{type:s,result:"success",code:t}}),e.onSuccess(i)},[k,T]=n.useState(!1),[,B]=(0,v.hQ)(),D=(0,b.Z)(),K={deviceId:(0,S.fd)(F),...D?{latitude:D.latitude,longitude:D.longitude}:{}},{unregisteredUserUuid:z}=(0,H.Z)();return L&&z?k?(0,l.tZ)(C.Z,{onRetry:()=>{T(!1)}}):(0,l.BX)(l.HY,{children:[(0,l.tZ)(f.Z,{eventName:"eats:payments_hub_start",eventPayload:{paymentsHubStart:{type:s}}}),(0,l.tZ)(x.Z,{type:"login",redirectTo:(0,_.Zs0)(i),children:e=>{let{onClick:s}=e;return(0,l.tZ)(p,{onSuccess:E,onError:()=>T(!0),onCancel:(e,n)=>{"sign_in"===e?s():t()},loadTimeout:h.Ej,Loader:()=>(0,l.tZ)(w.Z,{}),LoadError:e=>(0,l.tZ)(C.Z,{onRetry:e}),acceptableOrigins:u,context:K,origin:r,dimensions:{width:"100%",height:"100%"},publishableKey:a,integrationName:d,theme:B.colors.colorPreference,orderUuid:L,activeFlowsUseCaseKey:h.TO,viewOnlyFlowsUseCaseKey:h.Bf,guestUserUuid:z})}})]}):(t(),null)}},93553:(e,t,s)=>{s.d(t,{Z:()=>y});var n=s(14016),i=s(91931),o=s(79908),r=s(59924);const a=300,d=(0,i.zo)("div",(e=>{let{$theme:t,$isBackgroundTransparent:s}=e;return{height:"100%",width:"100%",display:"flex",flex:1,alignItems:"center",justifyContent:"center",textAlign:"center",background:s?"transparent":t.colors.backgroundPrimary}})),l=(0,i.zo)("div",(e=>{let{$theme:t}=e;return{paddingTop:"16px",textAlign:"center",...t.typography.ParagraphMedium,color:t.colors.contentSecondary}})),u=(0,i.zo)("div",{position:"relative",width:"100%",height:"135px"}),p=(0,i.w1)(l,(e=>{let{index:t,total:s}=e;const n=2600,i=n*s;return{position:"absolute",width:"100%",opacity:0,animationIterationCount:"infinite",animationDelay:`${t*n}ms`,animationDuration:`${i}ms`,animationName:{"0%":{opacity:0},[`${Math.round(a/i*100)}%`]:{opacity:1},[`${Math.round(2300/i*100)}%`]:{opacity:1},[`${Math.round(n/i*100)}%`]:{opacity:0}}}})),c="45px",h=(0,i.zo)("div",(()=>({width:c,marginLeft:"auto",marginRight:"auto"})));const y=function(e){const t=(0,n.T)(),s=Boolean(e.isLoaderOnly),i=["",t("payment-hub.loader.step.1"),t("payment-hub.loader.step.2"),t("payment-hub.loader.step.3")];return(0,r.tZ)(d,{$isBackgroundTransparent:s,children:(0,r.BX)("div",{style:{width:"80%"},children:[(0,r.tZ)(h,{children:(0,r.tZ)(o.Z,{type:"Loading",width:c,height:c,ariaLabel:t("loading"),color:"loading"})}),s?(0,r.tZ)(r.HY,{}):(0,r.tZ)(u,{children:i.map(((e,t)=>(0,r.tZ)(p,{"data-test":"loader.text",index:t,total:i.length,children:e},t)))})]})})}},85293:(e,t,s)=>{s.d(t,{Z:()=>w});var n=s(46933),i=s(59924);const o=()=>(0,i.BX)("svg",{width:"80",height:"80",viewBox:"0 0 80 80",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.tZ)("path",{d:"M2.47893 70.412L38.5231 7.93537C39.1239 6.81972 40.7545 6.81972 41.441 7.93537L77.571 70.412C78.1718 71.5277 77.3994 72.9008 76.1121 72.9008H3.85205C2.56475 72.9008 1.79238 71.5277 2.47893 70.412Z",fill:"#F25138"}),(0,i.tZ)("path",{d:"M12.5195 66.2926L39.9818 18.7485L67.444 66.2926H12.5195Z",fill:"black"}),(0,i.tZ)("path",{d:"M39.9808 54.7924C40.6674 54.7924 41.2681 55.0498 41.783 55.5647C42.298 56.0797 42.5554 56.6804 42.5554 57.367C42.5554 58.0535 42.298 58.6542 41.783 59.1692C41.2681 59.6841 40.6674 59.9415 39.9808 59.9415C39.2943 59.9415 38.6077 59.6841 38.1786 59.1692C37.6637 58.6542 37.4062 58.0535 37.4062 57.367C37.4062 56.6804 37.6637 56.0797 38.1786 55.5647C38.6935 55.0498 39.2943 54.7924 39.9808 54.7924ZM38.007 52.5611L37.6637 34.1099H42.3838L41.9547 52.5611H38.007Z",fill:"white"})]}),r={backgroundColor:"#000000",color:"#FFFFFF",width:"100%",lineHeight:"28px",fontSize:"20px",minHeight:"56px",border:"none",cursor:"pointer"},a={backgroundColor:"#EEEEEE",color:"#000000",width:"100%",lineHeight:"28px",fontSize:"20px",height:"56px",border:"none",cursor:"pointer",marginTop:"16px"},d={display:"flex",flexDirection:"column",height:"100%",boxSizing:"border-box",fontFamily:"inherit"},l={display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1,flexShrink:1,flexWrap:1,justifyContent:"center",fontFamily:"inherit",minWidth:0,paddingTop:0,paddingRight:"16px",paddingBottom:"16px",paddingLeft:"16px"},u={fontSize:"24px",fontFamily:"inherit",lineHeight:"40px",textAlign:"center",width:"100%",marginTop:"24px"},p={fontSize:"14px",fontFamily:"inherit",lineHeight:"24px",textAlign:"center",width:"100%",paddingTop:"16px",paddingRight:"25px",paddingBottom:0,paddingLeft:"25px",boxSizing:"border-box",marginTop:"24px"},c={flexGrow:0,flexShrink:0,paddingTop:0,paddingRight:"16px",paddingBottom:"16px",paddingLeft:"16px"},h=e=>{let{header:t}=e;return(0,i.BX)("div",{style:u,children:[" ",t," "]})},y=e=>{let{description:t}=e;return(0,i.BX)("div",{style:p,children:[" ",t," "]})},m=e=>(0,i.BX)("div",{style:l,children:[(0,i.tZ)(o,{}),e.header&&(0,i.tZ)(h,{...e}),e.description&&(0,i.tZ)(y,{...e})]}),g=e=>(0,i.tZ)("button",{onClick:e.onAction,style:{...r,...e.styleOverrides?.primaryButton},children:e.action}),Z=e=>(0,i.tZ)("button",{onClick:e.onCancel,style:{...a,...e.styleOverrides?.secondaryButton},children:e.cancel}),f=e=>(0,i.BX)("div",{style:c,children:[e.action&&(0,i.tZ)(g,{...e}),e.cancel&&(0,i.tZ)(Z,{...e})]}),C=e=>(0,i.BX)("div",{style:d,children:[(0,i.tZ)(m,{...e}),(0,i.tZ)(f,{...e})]}),b=e=>(0,i.tZ)(C,{...e});function w(e){const t=e.title||(0,i.tZ)(n.v,{id:"components.genericError.title"}),s=e.buttonText||(0,i.tZ)(n.v,{id:"shared.retry"});return(0,i.tZ)(b,{header:t,description:e.message,action:s,onAction:e.onRetry})}},85244:(e,t,s)=>{s.d(t,{Z:()=>P});var n=s("__fusion__476"),i=s(5617),o=s(74369),r=s(11137),a=s(62322),d=s(36262),l=s(93649),u=s(66493),p=s(59924);class c extends n.Component{state={dimensions:{height:0,width:0}};constructor(e){super(e),e.dimensions&&(this.state.dimensions=e.dimensions)}resolve=e=>{if("add_needs_display"===e.resultCode){const e=this.props.onNeedsDisplay;if(!e)return;const{height:t,width:s}=(0,d.UL)(r.window.innerHeight,r.window.innerWidth),n=e(t,s);return this.setState({dimensions:n})}e.resultCode!==l.lw.closed&&e.resultCode!==l.lw.openFailed?"success"!==e.result?"add_cancelled"===e.resultCode&&this.props.onCancel?this.props.onCancel():"error"!==e.result||this.props.onFailure(e):this.props.onSuccess(e):this.props.onFailure({result:"error",flow:"add",message:""})};shouldHideLoader=e=>e&&"add_needs_display"===e.resultCode;resolutionHandler=e=>{this.resolve(e)};render(){const{giftCode:e,disablePaymentMethodsList:t,paymentMethod:s,hideCancel:n,authenticationFlowId:i}=this.props,o=(0,d.t0)(this.props,this.state.dimensions),r=(0,d.HF)(this.props.origin,t?void 0:s),l=(0,d.pT)(this.props,"add",{prefetch:(0,a.HJ)()}),c=(0,d.DZ)(this.props,this.shouldHideLoader),h=this.props.title||"Uber - Add a payment method",y=e?{giftCode:e}:{};return t&&s&&(y.paymentMethod=s),n&&(y.hideCancel="true"),i&&(y.authenticationFlowId=i),(0,p.tZ)(u.Z,{resolutionHandler:this.resolutionHandler,publishableKey:this.props.publishableKey,useCaseKey:this.props.useCaseKey,integrationName:this.props.integrationName,organizationUuid:this.props.organizationUuid,embedMode:this.props.embedMode,redirectUrl:this.props.redirectUrl,options:o,url:r,analytics:l,load:c,title:h,urlSearchParams:y})}}var h=s(33535),y=s(65602),m=s(95818),g=s(19972),Z=s(65478),f=s(22065),C=s(37649),b=s(85293),w=s(54669),v=s(93553),x=s(15649),_=s(91931),U=s(47986),H=s(44756);function S(e){const t=(0,x.Z)(),s="add-payment",n=(0,h.ZP)(),i=(0,f.Z)(),r=(0,g.Z)(),a=(0,Z.Z)(),d=(0,m.Z)(),[l,u]=o.useState(!1),[,S]=(0,_.hQ)(),P=(0,w.Z)(),F=P?{latitude:P.latitude,longitude:P.longitude}:{},{paymentMethod:L=""}=(0,U.vRw)();return l?(0,p.tZ)(b.Z,{onRetry:()=>{u(!1)}}):(0,p.BX)(p.HY,{children:[(0,p.tZ)(C.Z,{eventName:"eats:payments_hub_start",eventPayload:{paymentsHubStart:{type:s}}}),(0,p.tZ)(c,{onSuccess:t=>{n("eats:payments_hub_end",{paymentsHubEnd:{type:s,result:"success",code:t.result}}),e.onSuccess(t)},onFailure:()=>{u(!0)},loadTimeout:y.Ej,Loader:()=>(0,p.tZ)(v.Z,{}),LoadError:e=>(0,p.tZ)(b.Z,{onRetry:e}),acceptableOrigins:d,context:F,origin:i,dimensions:{width:"100%",height:"100%"},publishableKey:r,integrationName:a,localeCode:t,theme:S.colors.colorPreference,paymentMethod:H.ho.has(L)?L:""})]})}function P(e){const t=(0,i.Z)(e.onSuccess),s=n.useCallback((e=>{let{uuid:s}=e;t(s)}),[t]);return(0,p.tZ)(S,{onSuccess:s})}},405:(e,t,s)=>{s.d(t,{Z:()=>H});var n=s("__fusion__476"),i=s(92431),o=s(87696),r=s(74369),a=s(11137),d=s(36262),l=s(93649),u=s(66493),p=s(59924);const c=Object.freeze({needsDisplay:"guestadd_needs_display",success:"success",paymentDataError:"payment_data_error",userClosed:"user_closed"});Object.freeze({signIn:"sign_in"});class h extends n.Component{state={dimensions:{height:0,width:0}};constructor(e){super(e),e.dimensions&&(this.state.dimensions=e.dimensions)}resolve=e=>{const{resultCode:t}=e;if(t===c.needsDisplay){const e=this.props.onNeedsDisplay;if(!e)return;const{height:t,width:s}=(0,d.UL)(a.window.innerHeight,a.window.innerWidth),n=e(t,s);return this.setState({dimensions:n})}t!==c.userClosed&&t!==l.lw.closed||this.props.onCancel(c.userClosed,e.orderUuid,e.linkTarget),e.resultCode!==c.success?e.resultCode!==c.paymentDataError&&t!==l.lw.openFailed||this.props.onError(e.resultCode,e.orderUuid):this.props.onSuccess(e.resultCode,e.orderUuid,{tokenType:e.tokenType,tokenData:e.tokenData})};shouldHideLoader=e=>e&&e.resultCode===c.needsDisplay;resolutionHandler=e=>{this.resolve(e)};render(){const e=(0,d.t0)(this.props,this.state.dimensions),t={orderUuid:this.props.orderUuid},s=(0,d.i$)(this.props.origin),n=(0,d.pT)(this.props,"guestadd"),i=(0,d.DZ)(this.props,this.shouldHideLoader),o=this.props.title||"Uber - Add a payment method";return(0,p.tZ)(u.Z,{resolutionHandler:this.resolutionHandler,publishableKey:this.props.publishableKey,useCaseKey:this.props.useCaseKey,integrationName:this.props.integrationName,organizationUuid:this.props.organizationUuid,urlSearchParams:t,embedMode:this.props.embedMode,redirectUrl:this.props.redirectUrl,options:e,url:s,analytics:n,load:i,title:o})}}var y=s(33535),m=s(65602),g=s(95818),Z=s(19972),f=s(65478),C=s(22065),b=s(37649),w=s(85293),v=s(54669),x=s(93553),_=s(91931);function U(e){const{orderUuid:t,onCancel:s}=e,n="guest-add-payment",i=(0,y.ZP)(),o=(0,C.Z)(),a=(0,Z.Z)(),d=(0,f.Z)(),l=(0,g.Z)(),[u,c]=r.useState(!1),[,U]=(0,_.hQ)(),H=(0,v.Z)(),S=H?{latitude:H.latitude,longitude:H.longitude}:{};return u?(0,p.tZ)(w.Z,{onRetry:()=>{c(!1)}}):(0,p.BX)(p.HY,{children:[(0,p.tZ)(b.Z,{eventName:"eats:payments_hub_start",eventPayload:{paymentsHubStart:{type:n}}}),(0,p.tZ)(h,{onSuccess:(t,s,o)=>{i("eats:payments_hub_end",{paymentsHubEnd:{type:n,result:"success",code:t}}),e.onSuccess(o.tokenData)},onError:()=>{c(!0)},onCancel:s,loadTimeout:m.Ej,Loader:()=>(0,p.tZ)(x.Z,{}),LoadError:e=>(0,p.tZ)(w.Z,{onRetry:e}),acceptableOrigins:l,context:S,origin:o,dimensions:{width:"100%",height:"100%"},publishableKey:a,integrationName:d,theme:U.colors.colorPreference,orderUuid:t})]})}function H(e){let{onCancel:t,onSuccess:s}=e;const r=(0,i.Z)(),a=(0,o.Ah)(r)||"",d=n.useCallback((e=>{s(e)}),[s]);return(0,p.tZ)(U,{onCancel:t,onSuccess:d,orderUuid:a})}},__fusion__357:(e,t,s)=>{s.r(t),s.d(t,{default:()=>a});var n=s(53683),i=s(93553),o=s(70305),r=s(59924);function a(){return(0,r.tZ)(n.ZP,{isBackgroundTransparent:!0,hasCloseButton:!1,onClose:()=>{},children:(0,r.tZ)(o.Z,{children:(0,r.tZ)(i.Z,{isLoaderOnly:!0})})})}},85249:(e,t,s)=>{s.d(t,{Z:()=>r});var n=s(74369),i=s(89151),o=s(62459);function r(){const[e,t]=(0,n.useState)(""),s=(0,o.Z)("createGuestPaymentProfileV2");return{createGuestPaymentProfile:(0,i.useMutation)((e=>s.request("createGuestPaymentProfileV2",e)),{onSuccess:e=>{t(e.paymentProfileUUID)}}),paymentProfileUUID:e}}},5617:(e,t,s)=>{s.d(t,{Z:()=>r});var n=s(74369),i=s(71576),o=s(68262);function r(e){const{refreshPaymentProfiles:t,shouldUsePaymentsHub:s}=(0,o.Z)(),r=(0,i.Z)("getUserV1"),[a,d]=(0,n.useState)(null);return(0,n.useEffect)((()=>{a&&(e(...a),d(null))}),[a,e]),(e,n,i,o)=>{(s?t():r()).then((t=>{d([e,n,i,o])})).catch((e=>{}))}}},89698:(e,t,s)=>{s.d(t,{P:()=>o});var n=s(60849),i=s(79620);function o(){return(0,n.ip)({...i.S.guest_checkout_payment_expansion,defaultValue:!1})}},95818:(e,t,s)=>{s.d(t,{Z:()=>i});var n=s(22065);function i(){(0,n.Z)();return[]}}}]);